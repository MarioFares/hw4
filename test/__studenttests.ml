open Util.Assert
open Gradedtests

let mandel_output =
"                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                ##                                               
                                                                               ##                                                
                                                                            #########                                            
                                                                            #########                                            
                                                                             ########                                            
                                                                             #######                                             
                                                                    #       #########                                            
                                                               #      ######################                                     
                                                               ### ###########################  ####                             
                                                               ################################ ####                             
                                                              #####################################                              
                                                             ######################################                              
                                                          ##########################################                             
                                                           ##########################################                            
                                                        ################################################                         
                                                         ############################################                            
                                    ##    ##            ##############################################                           
                                    ## ##########      ################################################                          
                                    ##############     ###############################################                           
                                  ##################  ################################################                           
                                 #################### ###############################################                            
                                 #################### ###############################################                            
                           #########################################################################                             
#################################################################################################                                
                           #########################################################################                             
                                 #################### ###############################################                            
                                 #################### ###############################################                            
                                  ##################  ################################################                           
                                    ##############     ###############################################                           
                                    ## ##########      ################################################                          
                                    ##    ##           ###############################################                           
                                                         ############################################                            
                                                        ################################################                         
                                                           ##########################################                            
                                                          ##########################################                             
                                                             ######################################                              
                                                              #####################################                              
                                                               ################################ ####                             
                                                               ### ###########################  ####                             
                                                               # #    ######################                                     
                                                                            #########                                            
                                                                             #######                                             
                                                                             ########                                            
                                                                            #########                                            
                                                                            #########                                            
                                                                               ##                                                
                                                                                ##                                               
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 
                                                                                                                                 "
let gol_output =
"..X.....................
X.X.....................
.XX.....................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................

........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
........................
..................X.....
................X.X.....
.................XX.....
........................
........................
........................
........................
........................"

let nqueens_output = 
"10000000
00000010
00001000
00000001
01000000
00010000
00000100
00100000" 

(* We have to double-escape because the arguments are processed by the shell *)
let args1, args2 = "foo baz", "foo bar baz \\\" \\\\ rhinoceros elephant"
let args1_out, args2_out =
"Strings at index 1 mismatched: expected bar, got baz",
"Your arguments in order:
\"
\\
bar
baz
elephant
foo
rhinoceros
And some integers:
55
55
55"

let provided_tests : suite = [
    Test("Ed Tests", [
      "Mandelbrot",   assert_eqfs (fun () -> oat_file_test "hw4programs/ed_tests/mandelbrot.oat" "") (mandel_output ^ "1");
      "Game of Life", assert_eqfs (fun () -> oat_file_test "hw4programs/ed_tests/gameoflife.oat" "") (gol_output ^ "0");
      "Args 1",       assert_eqfs (fun () -> oat_file_test "hw4programs/ed_tests/args.oat" args1) (args1_out ^ "1");
      "Args 2",       assert_eqfs (fun () -> oat_file_test "hw4programs/ed_tests/args.oat" args2) (args2_out ^ "0");
      "N Queens",       assert_eqfs (fun () -> oat_file_test "hw4programs/ed_tests/nqueens.oat" "") (nqueens_output ^ "0");
      "for land", assert_eqfs (fun () -> oat_file_test "hw4programs/ed_tests/my_test.oat" "") ("50")
    ]);
]